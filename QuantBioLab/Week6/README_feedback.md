Not a bad start! Minor comment on the heatmap:  you'll want to set the xlimits on the eigenvector plot so that they stretch to the edge of the plot. We would also want the heatmap to be square. As of right now, you're writing the eigenvalues and eigenvectors directly to `compartments.bed` but this is not a bed file. Make sure you understand what the bed format looks like. (-0.5) Regarding your command line commands, I'm a little confused by the order. We want to normalize the H3K27me3 measurements (your first awk command). Then we want to map those values onto the FPKM file (what you have as your bedtools map command). Then we want to normalize by gene length (your second awk command). Then we want to map the comparments onto the FPKM file (a second bedtools command that you don't have) (-0.25 points). It's this final file we'll use to make the violin plots. As of right now, I believe you're determining whether a gene is in compartment A or B by the + or - which actually denotes whether the gene is on the forward or reverse strand. (-0.5)

2.75/4
